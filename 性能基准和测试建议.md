# ğŸ“Š æ€§èƒ½åŸºå‡†å’Œæµ‹è¯•å»ºè®®

**åŸºäºåŠŸèƒ½éš¾åº¦åˆ†ç±»æ–‡æ¡£çš„å»¶ä¼¸**  
**ç‰ˆæœ¬**ï¼šv1.0.0 | **æ—¥æœŸ**ï¼š2025-11-16

---

## ğŸ“ˆ æ€§èƒ½åŸºå‡†å»ºè®®

### 1ï¸âƒ£ ImageScanner.ScanAndExtractInfo

**æµ‹è¯•åœºæ™¯**ï¼š
- å°è§„æ¨¡ï¼š100 å¼ å›¾ç‰‡ï¼Œæ··åˆæ ¼å¼ (PNG/JPEG/WebP)
- ä¸­è§„æ¨¡ï¼š1,000 å¼ å›¾ç‰‡
- å¤§è§„æ¨¡ï¼š10,000 å¼ å›¾ç‰‡

**é¢„æœŸæ€§èƒ½ç›®æ ‡**ï¼š

| è§„æ¨¡ | æ–‡ä»¶æ•° | ç›®æ ‡è€—æ—¶ | å¹³å‡é€Ÿåº¦ | å†…å­˜å ç”¨ |
|---|---|---|---|---|
| å° | 100 | < 30s | > 3 å¼ /ç§’ | < 100 MB |
| ä¸­ | 1,000 | < 5 åˆ†é’Ÿ | > 3 å¼ /ç§’ | < 300 MB |
| å¤§ | 10,000 | < 50 åˆ†é’Ÿ | > 3 å¼ /ç§’ | < 500 MB |

**æ€§èƒ½ç“¶é¢ˆ**ï¼š
- âš ï¸ å…ƒæ•°æ®æå–ï¼ˆMetadataExtractor åº“çš„ IO æ“ä½œï¼‰
- âš ï¸ æ ‡ç­¾æ¸…æ´—ï¼ˆæ­£åˆ™è¡¨è¾¾å¼å¤„ç†ï¼‰

**ä¼˜åŒ–å»ºè®®**ï¼š
1. ç¼“å­˜å…ƒæ•°æ®æå–ç»“æœï¼ˆLRU Cacheï¼Œç”Ÿå­˜æœŸ 24hï¼‰
2. ä½¿ç”¨å¼‚æ­¥ I/Oï¼ˆTask.WhenAllï¼‰å¹¶è¡Œæ‰«æå¤šä¸ªç›®å½•
3. å¹¶å‘åº¦è°ƒæ•´ï¼šå½“å‰ `MaxConcurrentWorkers = 4`ï¼Œå¯ä»¥å°è¯• 8-16

---

### 2ï¸âƒ£ ExcelReportGenerator.CreateExcelReport

**æµ‹è¯•åœºæ™¯**ï¼š
- å°ï¼š100 è¡Œæ•°æ®
- ä¸­ï¼š1,000 è¡Œæ•°æ®
- å¤§ï¼š10,000 è¡Œæ•°æ®

**é¢„æœŸæ€§èƒ½ç›®æ ‡**ï¼š

| è§„æ¨¡ | è¡Œæ•° | ç›®æ ‡è€—æ—¶ | æ–‡ä»¶å¤§å° |
|---|---|---|---|
| å° | 100 | < 2s | < 50 KB |
| ä¸­ | 1,000 | < 5s | < 500 KB |
| å¤§ | 10,000 | < 30s | < 5 MB |
| è¶…å¤§ | 100,000 | è¶…è¿‡ ClosedXML é™åˆ¶ | N/A |

**æ€§èƒ½ç“¶é¢ˆ**ï¼š
- âš ï¸ ClosedXML çš„å†…å­˜å ç”¨ï¼ˆå…¨æ–‡æ¡£ DOM æ ‘ï¼‰
- âš ï¸ å¤§æ–‡ä»¶ç£ç›˜å†™å…¥

**ä¼˜åŒ–å»ºè®®**ï¼š
1. **åˆ†é¡µå¯¼å‡º**ï¼šè¶…è¿‡ 10,000 è¡Œæ—¶ï¼Œåˆ†æˆå¤šä¸ª Sheet æˆ–å¤šä¸ªæ–‡ä»¶
2. **æµå¼å†™å…¥**ï¼šè‡ªç ”æµå¼ Excel å†™å…¥å™¨ï¼ˆå¦‚ EPPlus 5.0 é«˜çº§ APIï¼‰
3. **åˆ—å®½ä¼˜åŒ–**ï¼šç§»é™¤è‡ªåŠ¨è°ƒæ•´åˆ—å®½çš„ä»£ç ï¼ˆå·²åœ¨ v1.1 ä¸­æ³¨é‡Šï¼‰

---

### 3ï¸âƒ£ FileArchiver.ExecuteArchiving

**æµ‹è¯•åœºæ™¯**ï¼š
- å°ï¼š100 ä¸ªæ–‡ä»¶ï¼Œæ— ä¿æŠ¤ç›®å½•
- ä¸­ï¼š1,000 ä¸ªæ–‡ä»¶ï¼ŒåŒ…å« 5 ä¸ªä¿æŠ¤ç›®å½•
- å¤§ï¼š10,000 ä¸ªæ–‡ä»¶ï¼ŒåµŒå¥—ç›®å½•ç»“æ„

**é¢„æœŸæ€§èƒ½ç›®æ ‡**ï¼š

| è§„æ¨¡ | æ–‡ä»¶æ•° | ç›®æ ‡è€—æ—¶ | æˆåŠŸç‡ |
|---|---|---|---|
| å° | 100 | < 10s | 99%+ |
| ä¸­ | 1,000 | < 2 åˆ†é’Ÿ | 99%+ |
| å¤§ | 10,000 | < 20 åˆ†é’Ÿ | 99%+ |

**æ€§èƒ½ç“¶é¢ˆ**ï¼š
- âš ï¸ ç›®å½•é€’å½’éå†ï¼ˆç¬¦å·é“¾æ¥å¯èƒ½å¯¼è‡´æ— é™å¾ªç¯ï¼‰
- âš ï¸ æ–‡ä»¶ç§»åŠ¨æ“ä½œï¼ˆç½‘ç»œç›˜è¾ƒæ…¢ï¼‰
- âš ï¸ ç©ºç›®å½•é€’å½’åˆ é™¤

**ä¼˜åŒ–å»ºè®®**ï¼š
1. æ·»åŠ ç›®å½•éå†æ·±åº¦é™åˆ¶å’Œè®¿é—®æ—¶é—´é™åˆ¶ï¼ˆ10 ç§’è¶…æ—¶ï¼‰
2. æ£€æŸ¥ç¬¦å·é“¾æ¥ï¼Œè·³è¿‡å·²è®¿é—®ç›®å½•ï¼ˆä½¿ç”¨ HashSet<string> è¿½è¸ªï¼‰
3. æ¸…ç†ç©ºç›®å½•æ”¹ä¸ºåå°å¼‚æ­¥ä»»åŠ¡
4. æ‰¹é‡ç§»åŠ¨ä¼˜åŒ–ï¼šé¢„å…ˆåˆ›å»ºç›®æ ‡ç›®å½•ï¼Œé¿å…å•ä¸ªæ–‡ä»¶åˆ›å»ºç›®å½•

---

### 4ï¸âƒ£ TfidfProcessor.ExtractTfidfTags

**æµ‹è¯•åœºæ™¯**ï¼š
- å°ï¼š100 ä¸ªæ ‡ç­¾æ–‡æ¡£ï¼Œè¯æ±‡é‡ 500 ä¸ªè¯
- ä¸­ï¼š1,000 ä¸ªæ ‡ç­¾æ–‡æ¡£ï¼Œè¯æ±‡é‡ 5,000 ä¸ªè¯
- å¤§ï¼š10,000 ä¸ªæ ‡ç­¾æ–‡æ¡£ï¼Œè¯æ±‡é‡ 50,000 ä¸ªè¯

**é¢„æœŸæ€§èƒ½ç›®æ ‡**ï¼š

| è§„æ¨¡ | æ–‡æ¡£æ•° | è¯æ±‡é‡ | ç›®æ ‡è€—æ—¶ | å†…å­˜å ç”¨ |
|---|---|---|---|---|
| å° | 100 | 500 | < 5s | < 50 MB |
| ä¸­ | 1,000 | 5,000 | < 30s | < 200 MB |
| å¤§ | 10,000 | 50,000 | < 5 åˆ†é’Ÿ | < 1 GB |

**æ€§èƒ½ç“¶é¢ˆ**ï¼š
- âš ï¸ TF-IDF çŸ©é˜µè®¡ç®—ï¼ˆå½“å‰æ¨¡æ‹Ÿå®ç°ï¼ŒçœŸå®å®ç°ä¼šæ›´å¤æ‚ï¼‰
- âš ï¸ å†…å­˜å ç”¨ï¼ˆç¨ å¯†çŸ©é˜µ [æ–‡æ¡£æ•° x è¯æ±‡é‡]ï¼‰
- âš ï¸ å¹¶è¡Œéšæœºæ•°ç”Ÿæˆï¼ˆGuid.NewHashCode() æœ‰å¼€é”€ï¼‰

**ä¼˜åŒ–å»ºè®®**ï¼š
1. **ä½¿ç”¨ç¨€ç–çŸ©é˜µ**ï¼šå¤§å¤šæ•° TF-IDF å€¼ä¸º 0ï¼Œæ”¹ç”¨ç¨€ç–è¡¨ç¤ºå¯å‡å°‘ 80-90% å†…å­˜
2. **æ‰¹å¤„ç†**ï¼šåˆ†æ‰¹å¤„ç†æ–‡æ¡£ï¼Œè€Œéä¸€æ¬¡æ€§å…¨éƒ¨åŠ è½½
3. **ç¼“å­˜è¯æ±‡è¡¨**ï¼šå¤šæ¬¡è°ƒç”¨æ—¶ç¼“å­˜ç‰¹å¾è¯åˆ—è¡¨
4. **éšæœºæ•°ä¼˜åŒ–**ï¼šé¢„åˆ†é…éšæœºæ•°ç”Ÿæˆå™¨ï¼Œå‡å°‘ Guid.NewHashCode() è°ƒç”¨

---

## ğŸ§ª å•å…ƒæµ‹è¯•å»ºè®®

### ä¼˜å…ˆçº§ P0ï¼šå¿…é¡»æœ‰çš„å•å…ƒæµ‹è¯•

#### 1. ImageScanner æµ‹è¯•

```csharp
[Fact]
public void TestScanAndExtractInfo_EmptyDirectory()
{
    // Arrange: åˆ›å»ºç©ºç›®å½•
    // Act: æ‰«æ
    // Assert: è¿”å›ç©ºåˆ—è¡¨ï¼Œæ— å¼‚å¸¸
}

[Fact]
public void TestScanAndExtractInfo_MixedFormats()
{
    // Arrange: åˆ›å»ºåŒ…å« PNG/JPEG/WebP çš„ç›®å½•
    // Act: æ‰«æ
    // Assert: å…¨éƒ¨è¯†åˆ«ï¼Œå…ƒæ•°æ®æ­£ç¡®æå–
}

[Fact]
public void TestScanAndExtractInfo_WithSymlinks()
{
    // Arrange: åŒ…å«ç¬¦å·é“¾æ¥çš„ç›®å½•
    // Act: æ‰«æ
    // Assert: ä¸é™·å…¥æ— é™å¾ªç¯ï¼Œèƒ½å¤Ÿå®Œæˆ
}

[Fact]
public void TestScanAndExtractInfo_LargeFile()
{
    // Arrange: è¶…å¤§å›¾ç‰‡æ–‡ä»¶ï¼ˆ>500 MBï¼‰
    // Act: æ‰«æ
    // Assert: å¼‚å¸¸å¤„ç†ï¼Œä¸å´©æºƒ
}

[Fact]
public void TestExtractMetadata_CorruptedImage()
{
    // Arrange: æŸåçš„å›¾ç‰‡æ–‡ä»¶
    // Act: æå–å…ƒæ•°æ®
    // Assert: è¿”å›ç©ºå­—ç¬¦ä¸²æˆ–éƒ¨åˆ†ç»“æœï¼Œä¸æŠ›å¼‚å¸¸
}
```

#### 2. FileArchiver æµ‹è¯•

```csharp
[Fact]
public void TestExecuteArchiving_ProtectedFolder()
{
    // Arrange: åŒ…å«"è¶…"ã€"ç²¾"å…³é”®è¯çš„å—ä¿æŠ¤æ–‡ä»¶å¤¹
    // Act: æ‰§è¡Œå½’æ¡£
    // Assert: ä¿æŠ¤æ–‡ä»¶å¤¹å†…æ–‡ä»¶ä¸è¢«ç§»åŠ¨
}

[Fact]
public void TestMoveFileSafe_FileAlreadyExists()
{
    // Arrange: ç›®æ ‡ç›®å½•å·²å­˜åœ¨åŒåæ–‡ä»¶
    // Act: ç§»åŠ¨æ–‡ä»¶
    // Assert: è‡ªåŠ¨é‡å‘½åæˆ–è·³è¿‡ï¼Œä¸è¦†å†™
}

[Fact]
public void TestMoveFileSafe_PermissionDenied()
{
    // Arrange: ç›®æ ‡ç›®å½•æƒé™ä¸è¶³
    // Act: å°è¯•ç§»åŠ¨
    // Assert: å¼‚å¸¸æ•è·ï¼Œè®¡æ•°ç»Ÿè®¡ï¼Œå…¶ä»–æ–‡ä»¶ç»§ç»­
}

[Fact]
public void TestCleanEmptyDirectories_RaceCondition()
{
    // Arrange: åœ¨æ¸…ç†æ—¶æœ‰å…¶ä»–è¿›ç¨‹åˆ›å»ºæ–°æ–‡ä»¶
    // Act: æ¸…ç†ç©ºç›®å½•
    // Assert: éƒ¨åˆ†åˆ é™¤æˆåŠŸï¼Œä¸å¯¼è‡´å¼‚å¸¸
}
```

#### 3. FilenameTagger æµ‹è¯•

```csharp
[Fact]
public void TestTagFiles_ExcessivelyLongName()
{
    // Arrange: æ ‡ç­¾å¯¼è‡´æ–‡ä»¶åè¶…è¿‡ 260 å­—ç¬¦
    // Act: ç”Ÿæˆæ–°æ–‡ä»¶å
    // Assert: è‡ªåŠ¨æˆªæ–­æˆ–è­¦å‘Šï¼Œä¸å¤±è´¥
}

[Fact]
public void TestGetUniqueFilename_ConcurrentCreate()
{
    // Arrange: å¤šçº¿ç¨‹åŒæ—¶é‡å‘½ååˆ°åŒä¸€ç›®å½•
    // Act: å¹¶å‘è°ƒç”¨ GetUniqueFilename
    // Assert: æ‰€æœ‰æ–‡ä»¶åå”¯ä¸€ï¼Œæ— é‡å¤
}

[Fact]
public void TestTagFiles_IllegalCharacters()
{
    // Arrange: æ ‡ç­¾åŒ…å« < > : " | ? * ç­‰éæ³•å­—ç¬¦
    // Act: ç”Ÿæˆæ–‡ä»¶å
    // Assert: å­—ç¬¦è½¬ä¹‰æˆ–ç§»é™¤ï¼Œæ–‡ä»¶ååˆæ³•
}
```

#### 4. ExcelReportGenerator æµ‹è¯•

```csharp
[Fact]
public void TestCreateExcelReport_LargeDataset()
{
    // Arrange: 10,000 è¡Œæ•°æ®
    // Act: ç”Ÿæˆ Excel
    // Assert: å®Œæˆï¼Œæ–‡ä»¶å¯æ‰“å¼€
}

[Fact]
public void TestCreateExcelReport_SpecialCharacters()
{
    // Arrange: æ•°æ®åŒ…å«ä¸­æ–‡ã€emojiã€ç‰¹æ®Šç¬¦å·
    // Act: ç”Ÿæˆ Excel
    // Assert: å­—ç¬¦æ­£ç¡®ç¼–ç ï¼Œå¯è¯»
}

[Fact]
public void TestCreateExcelReport_FileOverwrite()
{
    // Arrange: æ–‡ä»¶å·²å­˜åœ¨
    // Act: ç”Ÿæˆæ–°æŠ¥å‘Š
    // Assert: è¦†å†™æˆ–ç”Ÿæˆæ–°æ–‡ä»¶å
}
```

### ä¼˜å…ˆçº§ P1ï¼šå»ºè®®æœ‰çš„å•å…ƒæµ‹è¯•

#### 5. TfidfProcessor æµ‹è¯•

```csharp
[Fact]
public void TestExtractTfidfTags_EmptyTags()
{
    // ç©ºæ ‡ç­¾åˆ—è¡¨çš„å¤„ç†
}

[Fact]
public void TestExtractTfidfTags_DuplicateTags()
{
    // é‡å¤æ ‡ç­¾çš„ TF-IDF è®¡ç®—
}

[Fact]
public void TestExtractTfidfTags_LargeVocabulary()
{
    // 50,000+ è¯æ±‡çš„æ€§èƒ½æµ‹è¯•
}
```

#### 6. ScoreOrganizer æµ‹è¯•

```csharp
[Fact]
public void TestParseScoreInput_EdgeCases()
{
    // è¾¹ç•Œå€¼ï¼š10ã€99ã€10-99 ç­‰
}

[Fact]
public void TestOrganizeFiles_BatchOperation()
{
    // 1,000+ æ–‡ä»¶çš„æ‰¹é‡ç§»åŠ¨
}
```

---

## ğŸ”„ é›†æˆæµ‹è¯•å»ºè®®

### ç«¯åˆ°ç«¯æµç¨‹æµ‹è¯•

#### æµç¨‹ 1ï¼šå®Œæ•´æ‰«æåˆ°æŠ¥å‘Šç”Ÿæˆ

```csharp
[Fact]
public async Task TestE2E_ScanToReportGeneration()
{
    // 1. ä½¿ç”¨æµ‹è¯•æ•°æ®ç›®å½•ï¼ˆåŒ…å« 100+ å¼ å›¾ç‰‡ï¼‰
    // 2. æ‰§è¡Œ ImageScanner.ScanAndExtractInfo
    // 3. éªŒè¯ç»“æœæ•°æ®å®Œæ•´æ€§
    // 4. æ‰§è¡Œ ExcelReportGenerator.CreateExcelReport
    // 5. éªŒè¯ Excel æ–‡ä»¶æœ‰æ•ˆæ€§
    // 6. æ¸…ç†æµ‹è¯•æ–‡ä»¶
}
```

#### æµç¨‹ 2ï¼šæ–‡ä»¶æ“ä½œæµç¨‹ï¼ˆå½’æ¡£ + åˆ†ç±» + é‡å‘½åï¼‰

```csharp
[Fact]
public async Task TestE2E_FileOperations()
{
    // 1. åˆ›å»ºæµ‹è¯•ç›®å½•ç»“æ„ï¼ˆåŒ…å«ä¿æŠ¤ç›®å½•ï¼‰
    // 2. æ‰§è¡Œ FileArchiver.ExecuteArchiving
    // 3. éªŒè¯å½’æ¡£æˆåŠŸä¸”ä¿æŠ¤ç›®å½•æœªè¢«ä¿®æ”¹
    // 4. æ‰§è¡Œ FileCategorizer.CategorizeAndMoveImages
    // 5. éªŒè¯åˆ†ç±»æ­£ç¡®
    // 6. æ‰§è¡Œ FilenameTagger.TagFiles
    // 7. éªŒè¯æ–‡ä»¶åæ›´æ–°ä¸”å”¯ä¸€
    // 8. æ¸…ç†æ‰€æœ‰æµ‹è¯•æ–‡ä»¶
}
```

---

## ğŸ“‹ æ€§èƒ½æµ‹è¯•æ£€æŸ¥æ¸…å•

- [ ] **CPU å ç”¨**ï¼šç›‘æ§å³°å€¼å’Œå¹³å‡å ç”¨ï¼ˆç›®æ ‡ <80%ï¼‰
- [ ] **å†…å­˜å ç”¨**ï¼šç›‘æ§å³°å€¼ï¼ˆç›®æ ‡æ ¹æ®æ•°æ®é‡åˆç†ï¼‰
- [ ] **ç£ç›˜ I/O**ï¼šç›‘æ§è¯»å†™é€Ÿåº¦å’Œ IOPS
- [ ] **ç½‘ç»œï¼ˆè‹¥é€‚ç”¨ï¼‰**ï¼šç›‘æ§ç½‘ç»œç›˜æ“ä½œçš„å»¶è¿Ÿ
- [ ] **å¹¶å‘å®‰å…¨**ï¼šå¤šçº¿ç¨‹åœºæ™¯ä¸‹çš„ç«æ€æ¡ä»¶
- [ ] **å¼‚å¸¸å¤„ç†**ï¼šå„ç§å¤±è´¥æƒ…å†µçš„æ¢å¤èƒ½åŠ›
- [ ] **æ‰©å±•æ€§**ï¼šæ•°æ®é‡å¢åŠ æ—¶çš„æ€§èƒ½æ›²çº¿

---

## ğŸ“Š æµ‹è¯•æŠ¥å‘Šæ¨¡æ¿

### å•æ¬¡æµ‹è¯•ç»“æœ

```markdown
## æµ‹è¯•æŠ¥å‘Šï¼šImageScanner.ScanAndExtractInfo

**æ—¥æœŸ**ï¼š2025-11-16  
**æµ‹è¯•ç¯å¢ƒ**ï¼šWindows 11, 16GB RAM, SSD  
**æµ‹è¯•æ•°æ®**ï¼š1,000 å¼  PNG å›¾ç‰‡ï¼ˆå¹³å‡ 2MBï¼‰

### æ€§èƒ½ç»“æœ

| æŒ‡æ ‡ | ç›®æ ‡ | å®é™… | çŠ¶æ€ |
|---|---|---|---|
| è€—æ—¶ | < 5 åˆ†é’Ÿ | 4 åˆ† 23 ç§’ | âœ… |
| å¹³å‡é€Ÿåº¦ | > 3 å¼ /ç§’ | 3.8 å¼ /ç§’ | âœ… |
| å†…å­˜å³°å€¼ | < 300 MB | 245 MB | âœ… |
| CPU å¹³å‡å ç”¨ | < 80% | 62% | âœ… |

### é—®é¢˜å’Œå»ºè®®

1. **å‘ç°çš„é—®é¢˜**ï¼š
   - æŸäº› WebP æ–‡ä»¶å…ƒæ•°æ®æå–å¤±è´¥ï¼ˆ5 ä¸ªæ–‡ä»¶ï¼‰
   
2. **æ”¹è¿›å»ºè®®**ï¼š
   - å¢å¼º WebP æ ¼å¼æ”¯æŒ
   - æ·»åŠ å¤±è´¥æ–‡ä»¶çš„é‡è¯•æœºåˆ¶

### ç­¾å

- æµ‹è¯•è€…ï¼š__________________
- æ—¥æœŸï¼š__________________
```

---

## ğŸ¯ CI/CD é›†æˆå»ºè®®

### GitHub Actions å·¥ä½œæµ

```yaml
name: Performance Benchmark

on: [push, pull_request]

jobs:
  benchmark:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v2
      - name: Setup .NET
        uses: actions/setup-dotnet@v1
        with:
          dotnet-version: '7.0'
      - name: Run unit tests
        run: dotnet test --verbosity normal
      - name: Run performance tests
        run: dotnet test --filter "Category=Performance" --verbosity normal
      - name: Upload results
        uses: actions/upload-artifact@v2
        with:
          name: test-results
          path: TestResults/
```

---

**å»ºè®®å®¡æŸ¥å‘¨æœŸ**ï¼šæ¯ä¸ªå­£åº¦æ‰§è¡Œä¸€æ¬¡å®Œæ•´çš„æ€§èƒ½åŸºå‡†æµ‹è¯•  
**æœ€åæ›´æ–°**ï¼š2025-11-16 18:20 UTC
